# 깃으로 버전 관리하기

## 깃 저장소 만들기

- 깃 초기화 하기 - git init
  - 깃을 사용할 수 있도록 디렉토리를 초기화하는 것
  - init은 initialize(초기화하다)의 약자
  - git init 사용 시 '.git'이라는 디렉토리가 생성됨
  - .git 디렉토리는 깃을 사용하면서 버전이 저장될 저장소

## 버전 만들기

- 깃에서 버전이란?
  - 깃에서 버전이란 문서를 수정하고 저장할 때마다 생기는 것
  - 파일을 다른 이름으로 저장해 버전을 만드는 방법보다 훨씬 쉽게 버전을 만들고 만든 시간과 수정 내용까지 기록할 수 있는 것이 바로 깃과 같은 버전 관리 시스템
  - 버전마다 작업했던 내용을 확인할 수 있고, 그 버전으로 되돌아갈 수도 있습니다.
- 스테이지와 커밋 이해하기
  - 깃에서 버전을 만드는 단계
    <img src="https://mung0001.github.io/ST.png">
  - 작업 트리
    - 파일 수정, 저장 등의 작업을 하는 디렉토리
  - 스테이지
    - 버전으로 만들 파일이 대기하는 곳
  - 저장소
    - 스테이지에서 대기하고 있던 파일들을 버전으로 만들어 저장하는 곳
  - 과정
    1. hello.txt 파일 문서를 수정하고 저장하면 그 파일은 작업 트리에 있게 됩니다. 그리고 수정한 hello.txt 파일을 버전으로 만들고 싶을 때 스테이지에 넣습니다. 다른 파일도 수정한 뒤 버전으로 만들겠다면 스테이지에 넣어 둡니다.
       <img src="https://mung0001.github.io/ST2.png">
    2. 파일 수정을 끝내고 스테이지에 다 넣었다면 버전을 만들기 위해 깃에게 '커밋(commit) 명령을 내립니다. 커밋 명령을 내리면 새로운 버전이 생성되면서 스테이지에 대기하던 파일이 모두 저장소에 저장됩니다.
       <img src="https://velog.velcdn.com/images%2F717lumos%2Fpost%2Fa880daaa-2602-4ec1-957f-492efcaecdea%2F4.png">
- 작업 트리에서 vim으로 문서 수정하기

  - git status
    - 깃 상태 확인을 할 수 있는 명령어

- 수정한 파일을 스테이징하기 - git add

  - 작업 트리에서 파일을 만들거나 수정했다면 스테이지에 수정한 파일을 추가합니다.
  - 깃에게 버전 만들 준비를 하라고 알려주는 것을 '스테이징' 또는 '스테이지에 올린다'라고 표현합니다.
  - 깃에서 스테이징할 때 사용하는 명령은 'git add'입니다.

- 스테이지에 올라온 파일 커밋하기 - git commit

  - 깃에서 버전을 만드는 것을 간단히 '커밋한다'라고 말합니다.
  - 커밋할 때는 어떤 변경 사항이 있었는지 확인하기 위해 메시지를 함께 기록해 두어야 합니다.
  - 깃에서 파일을 커밋하는 명령은 git commit입니다. 한 칸 띄운 후 -m 옵션을 붙이면 커밋과 함께 저장할 메시지를 적을 수 있습니다. 이 메시지를 커밋 메시지라고 합니다.
  - 저장소에 저장된 버전을 확인할 때는 git log 명령 사용

- 스테이징과 커밋 한꺼번에 처리하기 - git commit -am
  - commit 명령에 -am 옵션을 사용하면 스테이지에 올리고 커밋하는 과정을 한꺼번에 처리할 수 있습니다.
  - 다만, 이 방법은 한 번이라도 커밋한 적이 있는 파일을 다시 커밋할 때만 사용할 수 있습니다.

## 커밋 내용 확인하기

- 커밋 기록 자세히 살펴보기 - git log
  - git log 명령을 입력했을 때 나오는 정보를 묶어 간단히 '커밋 로그'라고 부릅니다.
- 변경 사항 확인하기 - git diff
  - 작업 트리에 있는 파일과 스테이지에 있는 파일을 비교하거나, 스테이지에 있는 파일과 저장소에 있는 최신 커밋을 비교해서 수정한 파일을 커밋하기 전에 최종적으로 검토할 수 있습니다.
  - 작업 트리에서 수정한 파일과 최신 버전을 비교한 다음, 수정한 내용으로 다시 버전을 만들려면 스테이지에 올린 후 커밋하고 수정한 내용을 버리려면 git checkout 명령을 사용해 수정 내용을 취소합니다.

## 버전 만드는 단계마다 파일 상태 알아보기

- tracked 파일과 untracked 파일

  - 깃은 한번이라도 커밋을 한 파일의 수정 여부를 계속 추적
  - 깃이 추적하고 있다는 뜻에서 tracked 파일이라고 부릅니다.
  - 반면 한 번도 깃에서 버전 관리를 하지 않은 파일은 untracked 파일이라고 표시합니다.
  - git add 명령 뒤에 파일 이름 대신 마침표(.)을 붙이면 작업 트리에서 수정한 파일을 한꺼번에 스테이지에 올릴 수 있습니다.
  - git log --stat을 사용하면 커밋에 관련된 파일까지 함께 볼 수 있다.
    - 로그 메시지가 너무 많을 경우 한 화면씩 나누어 보여줍니다. enter를 누르면 다음 로그 화면을 볼 수 있고, q를 누르면 로그 화면을 빠져 나와 다시 깃 명령을 입력할 수 있습니다.
  - .gitignore 파일로 버전 관리에서 제외하기
    - 버전 관리 중인 디렉토리 안에서 버전 관리를 하지 않을 특정 파일 또는 디렉토리가 있다면 .gitignore 파일을 만들어 목록을 지정할 수 있습니다.

- unmodified, modified, staged 상태
  - 메시지 : Changes not staged for commit:
    - 파일이 수정만 된 modified 상태
  - 메시지 : Changes to be committed:
    - 커밋 직전 단계, 즉 staged 상태
  - 방금 커밋한 메시지 수정하기 - git commit --amend

## 작업 되돌리기

- 작업 트리에서 수정한 파일 되돌리기 - git restore 파일 이름
  - restore로 되돌린 낸용은 다시 복구할 수 없습니다.
- 스테이징 되돌리기 - git restore --staged 파일 이름
  - 해당 파일을 스테이지에서 내리는 명령어
- 최신 커밋 되돌리기 - git reset HEAD^
  - HEAD^는 현재 HEAD가 가리키는 브랜치의 최신 커밋을 가리킵니다.
  - git reset HEAD^를 사용 시 커밋도 취소되고 스테이지에서도 내려집니다. 취소한 파일이 작업 트리에만 남습니다.
  - git reset 명령 옵션
    - '--soft HEAD^' : 최근 커밋을 하기 전 상태로 작업 트리를 되돌립니다.
    - '--mixed HEAD^' : 최근 커밋과 스테이징을 하기 전 상태로 작업 트리를 되돌립니다. 옵션 없이 git reset 명령을 사용할 경우 이 옵션을 기본으로 작동합니다.
    - '--hard HEAD^' : 최근 커밋과 스테이징, 파일 수정을 하기 전 상태로 작업 트리를 되돌립니다. 이 옵션으로 되돌린 낸용은 복구할 수 없습니다.
- 특정 커밋으로 되돌리기 - git reset 커밋 해시

  - reset에서 커밋 해시를 사용해 되돌릴 때 주의할 점
    - 예를 들어 reset A를 입력한다면 이 명령은 A 커밋을 리셋하는 것이 아니라 최근 커밋을 A로 리셋합니다. 즉 A 커밋을 삭제하는 것이 아니라 A 커밋 이후에 만들었던 커밋을 삭제하고, A 커밋으로 이동하겠다는 의미

- 커밋 삭제하지 않고 되돌리기 - git revert
  - 나중에 사용할 것을 대비해서 커밋을 되돌리더라도 취소한 커밋을 남겨두어야 할 때가 존재
  - 이 때 git revert 명령어 사용
  - revert 명령의 경우에는 revert 명령 뒤에 취소하려고 하는 버전의 커밋 해시를 입력해야 한다.
